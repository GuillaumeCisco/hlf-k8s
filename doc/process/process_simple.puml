@startuml

skinparam shadowing false

legend top left
  NODE_B_USER_A will ask NODE A
  susbtrabac for downloading an
  asset.
  It provides an username and
  a password in cookies
endlegend

package "Node A" as nodeA {
  rectangle "peer" as peerA {
    database ledgerA [
      ledger
      ----
      ----
    ]
  }
  rectangle "substrabac" as substrabacA {
    database localdbA [
      local db
      ----
      ----
    ]
    node server as djangoA
  }
  rectangle "Fabric CA" as fcaA {
    rectangle db as fcadbA {
        database usersA [
            users
            ----
            ----
        ]
        file {
            rectangle USER_A
            rectangle NODE_A_USER_B
        }
    }
    node server as fcaserverA
  }
}

package "Node B" as nodeB {
   rectangle "peer" as peerB {
    database ledgerB [
      ledger
      ----
      ----
    ]
  }
  rectangle "substrabac" as substrabacB {
    database localdbB [
      local db
      ----
      ----
    ]
    node server as djangoB
  }
  rectangle "Fabric CA" as fcaB {
    rectangle db as fcadbB {
        database usersB [
            users
            ----
            ----
        ]
        file {
            rectangle USER_B
            rectangle NODE_B_USER_A #PHYSICAL
        }
    }
    node server as fcaserverB
  }
}

nodeA -[hidden]- nodeB

djangoA <-[#orange]> localdbA
djangoB <-[#orange]> localdbB

fcaserverA <-[#orange]> usersA
fcaserverB <-[#orange]> usersB

NODE_B_USER_A ..> djangoA : ask download for processing

@enduml
